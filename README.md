## http-site
## Цель работы:
Спроектировать и разработать систему авторизации пользователей на протокоде HTTP
## Реализованные возможности
* функциональность входа/выхода
* хранение паролей в хешированном виде
* форма регистрации
* ограниичение времени сессии
* валидация пароля
## Ход работы
### 1. Создание сценариев
* #### Сценарий регистрации
1) Пользователь заходит на сайт и его перебрасывает на форму логина.
2) Клиент нажимает кнопку регистрация после чего оказывается на форме регистрации.
3) Клиент должен заполнить все поля и при успешном заполнении отправить форму, в противном случае будет выдаваться ошибка
регистрации.
3) После выполнения указаных действий пользователя перекинет на основную страничку сайта.
* #### Сценарий входа
1) Пользователь заходит на сайт и его перебрасывает на форму логина.
2) Клиент должен заполнить поля данными, которые он указывал при регистрации, и при успешном заполнении отправить форму,
в противном случае будет выдаваться ошибка входа.
3) После успешного входа пользователя перекинет на основную страничку сайта.
### 2. Создание структуры базы данных

Для хранения данных использовалась БД - MySQLite


| id      | name                               | login                | salt     | password                       |
|---------|------------------------------------|----------------------|----------|--------------------------------|
|1        |test                                |test                  |2F]4h^oU  |9dg14afda6221a78ec0cdeh5a372a145|
...

### 3. Описание алгоритмов
* Алгоритм действий пользователя при регистрации на сайте
![00](https://user-images.githubusercontent.com/90519017/198081346-e8bfc126-49df-499f-a3f1-9d3930a67b6d.png)

* Алгоритм действий пользователя при авторизации на сайте
![01](https://user-images.githubusercontent.com/90519017/198081442-f063c8f9-0c5b-438c-a052-04b473991b55.png)

### 4. Фрагменты кода

Код главной страницы и проверка есть ли куки:
```php
<?php
session_start();

if(!isset($_SESSION['auth'])){
    header('Location: login.php');
    exit;
} else {
    echo '<p class="success">Приветствую тебя, ', $_SESSION['name'], '!</p>';
}

?>
```

Код генерации соли:
```php
<?php
function generateSalt()
{
    $salt = '';
    $saltLength = 8;
    for($i=0; $i<$saltLength; $i++) {
        $salt .= chr(mt_rand(33,126));
    }
    return $salt;
}
?>
```

Код создания хешированого + посоленого пароля:
```php
$saltedPassword = md5(md5(md5(md5($password).$salt)).$salt);
```

Код создания сессии если пароль верен (при авторизации):
```php
if ($result['password'] == $saltedPassword) {

          session_start();

          $_SESSION['auth'] = true;
          $_SESSION['id'] = $result['id_user'];
          $_SESSION['login'] = $result['login'];
          $_SESSION['name'] = $result['name'];
 ```
## Примечания

* ### Сессия активна в течении 24 часов.
* ### Все запросы выполнены через POST.
